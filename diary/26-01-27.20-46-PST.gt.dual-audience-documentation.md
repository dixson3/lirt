# Documentation Pattern for Dual-Audience Gas Town Projects

**Date**: 2026-01-27 20:46 PST
**Town**: gt
**Type**: lesson
**Bead**: lirt-2wu

---

## The Lesson

Gas Town-instrumented projects that welcome both Claude Code agents and human developers face a unique documentation challenge: the agent sees a local structure (refinery/rig/, witness/, polecats/, crew/) that doesn't exist in the git repository. Documenting the local structure confuses external collaborators who clone the repo and see none of those directories.

**The insight**: Verify structure with git commands, not local filesystem observation. Document git reality first, local reality second, and make the distinction explicit.

## What Didn't Work

The initial README showed the local worktree structure in the "Project Layout" section:

```
lirt/
├── refinery/rig/     # Actual code location
├── witness/          # Agent monitoring
├── polecats/         # Ephemeral workers
├── crew/             # Isolated workspace
```

This is what agents see, but not what's in `github.com:dixson3/lirt.git`. External collaborators would be confused.

## What Worked

Five-step fix:

1. **Renamed "Project Layout" → "Repository Structure"** to signal we're showing git contents
2. **Used `git ls-tree -r --name-only HEAD`** to verify actual committed files
3. **Showed ONLY committed files** in the structure diagram
4. **Added "Branch Structure" section** explaining main vs beads-sync branches
5. **Added "What's NOT in This Repo" section** explicitly listing Gas Town local directories

The result: Clear separation between what's in git (`.claude/agents/`, `bin/`, `diary/`, `roles/`) and what's Gas Town local infrastructure.

## The Pattern Established

For dual-audience Gas Town projects:

1. **Verify with git commands** — Don't trust what you see locally. Run `git ls-tree` to check actual repository contents.
2. **Document git reality first** — Show the repository structure as it appears after `git clone`.
3. **Make the distinction EXPLICIT** — Separate "Repository Structure" from "What's NOT in This Repo".
4. **Include remote URL** — Add the GitHub URL in structure diagrams for clarity.
5. **Separate usage patterns** — Create distinct "For Claude Code Agents" and "For Human Developers" sections early in README.

## Implementation

**Commits**:
- `d792f58`: Fix README project layout to match actual git repository structure
- `f60a91b`: Add .beads/redirect to gitignore (machine-specific file)

**Files**: README.md:44-116

**Before/After Example**:

Before (confusing):
```markdown
## Project Layout
lirt/
├── refinery/rig/
├── witness/
```

After (clear):
```markdown
## Repository Structure
lirt/ (github.com:dixson3/lirt.git)
├── .claude/agents/
├── bin/

## What's NOT in This Repo
- refinery/rig/ - worktree checkout created by Gas Town
- witness/ - agent monitoring (Gas Town level)
```

## Why This Matters

External contributors need accurate mental models. If documentation shows local infrastructure:
- They're confused when directories don't exist after clone
- They don't understand what's agent-specific vs standard workflow
- They might create PRs touching Gas Town-local files

The fix ensures both audiences get clear, accurate information.

## Trade-offs

**Gained**:
- ✅ Accurate documentation matching git reality
- ✅ Clear audience separation (agents vs humans)
- ✅ No contributor confusion about missing directories

**Lost**:
- ❌ Slightly longer README (but well-structured with table of contents)

## Implications for Gas Town

- **Future rigs** (clio, others) should follow this documentation pattern
- **README templates** should distinguish git vs local structure
- **Consider town-level guideline**: "Documenting Dual-Audience Projects"
- **Applies beyond Gas Town**: Any project with runtime infrastructure not in git

This lesson generalizes to any situation where the development environment (what the agent sees) differs from the distributed artifact (what users clone).

## Related Work

- Commit 185e98f: First README rewrite (had this bug)
- [mayor/docs/BEADS-MEDIATED-COORDINATION.md](../../../../mayor/docs/BEADS-MEDIATED-COORDINATION.md): Similar pattern documentation at town level

---

**Chronicle bead**: lirt-2wu
**Labels**: cli-ux, documentation, lesson
